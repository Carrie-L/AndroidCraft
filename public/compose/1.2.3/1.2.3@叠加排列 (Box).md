
# 1.2.3 叠加排列 (Box)

## 1. 核心理论：Z 轴上的图层艺术

### 1.1 什么是 Box？
`Box` 的布局逻辑和 Android 原生的 `FrameLayout` 非常像，但更纯粹。
它的核心逻辑是 **“堆叠” (Stacking)**。
它把子元素放在一个虚拟的 **Z 轴**（垂直于屏幕向外的方向）上。

*   **默认行为**：所有子元素都会被放在 Box 的 **左上角 (0,0)**。
*   **覆盖规则**：
    *   先写的代码 = 放在底层（先画）。
    *   后写的代码 = 放在顶层（后画，覆盖前面的）。
    *   这就像 Photoshop 的图层：**下面的代码盖住上面的代码**。

### 1.2 为什么需要 Box？
你可能会问：“为什么不直接用 Row 或 Column？”
因为 Row 和 Column 的设计哲学是**“互不侵犯”**。它们不仅把元素摆好了，还确保元素之间不会重叠。
但在 UI 设计中，**重叠**是一种非常重要的表达方式：
*   **背景图 + 文字**：文字叠在图上。
*   **按钮 + 加载圈**：加载圈悬浮在按钮中心。
*   **角标**：红点悬浮在图标右上角。

这些场景，必须用 `Box`。

### 1.3 Box 的大小策略
`Box` 也是一个“看人下菜碟”的容器：
*   **如果没设置大小**：它会收缩包裹（Wrap）住它**最大**的那个子元素。
*   **比如**：一个 100x100 的图片和一个 20x20 的红点。Box 的大小就是 100x100。

---

## 2. 知识测验 (Quiz)

### 问题 1 [层级分析]
阅读代码，判断屏幕上最终能看到什么颜色？（假设它们大小一样，且位置完全重合）

```kotlin
Box {
    Text("底层", modifier = Modifier.background(Color.Red))   // 红色
    Text("中层", modifier = Modifier.background(Color.Green)) // 绿色
    Text("顶层", modifier = Modifier.background(Color.Blue))  // 蓝色
}
```

A. 红色
B. 绿色
C. 蓝色
D. 混在一起变成白色

> **思考后翻看答案**
>
> **答案：C**
> **解析**：代码执行顺序是从上到下，但绘制顺序是**后写的盖住先写的**。蓝色是最后声明的，所以它在最顶层（Z-Index 最高），完全挡住了下面的红色和绿色。

### 问题 2 [应用场景]
以下哪个场景**不适合**使用 `Box`？

A. 在视频播放器上显示“暂停”按钮。
B. 在用户头像旁边显示名字。
C. 做一个带有背景图片的卡片。
D. 给购物车图标加一个数字角标。

> **答案：B**
> **解析**：
> *   A（暂停盖在视频上）、C（字盖在图上）、D（数字盖在图标上）都是典型的重叠场景，适合 `Box`。
> *   B（头像旁边的名字）是左右并列关系，不重叠，应该用 `Row`。

---

## 3. 编码实战 (Code Lab)

**任务目标**：构建一个“带未读数的头像”。

我们需要做成这样的效果：
*   底层：一个灰色方块（模拟头像）。
*   顶层：一个红色小方块（模拟红点），显示在灰色方块的内部。

### 步骤 1：编写代码
在 `MainActivity.kt` 中定义 `BadgeAvatar`。

```kotlin
@Composable
fun BadgeAvatar() {
    // 1. 使用 Box 允许重叠
    Box {
        // 2. 底层：模拟头像
        // 这里用 Text 模拟，设置大一点
        Text(
            text = " 头像 ", 
            modifier = Modifier.background(Color.Gray) // 灰色背景
        )

        // 3. 顶层：模拟红点
        // 注意：因为 Box 默认都放在左上角，这两个 Text 会重叠在左上角
        // 我们暂时不管对齐（下一节才学 Alignment），先看重叠效果
        Text(
            text = "1", 
            modifier = Modifier.background(Color.Red) // 红色背景
        )
    }
}
```

### 步骤 2：运行与观察
在 `setContent` 中调用 `BadgeAvatar()`。

**现象**：
你会看到一个灰色方块，但在它的**左上角**，覆盖着一个红色的小方块（数字1）。红色挡住了灰色的一部分。

**思考**：
这证明了 `Box` 确实允许元素重叠。
但你肯定会觉得丑：**红点怎么能跑在左上角呢？它应该在右上角啊！**

这就引出了我们下一大节的关键主题 —— **1.3 布局对齐策略 (Alignment & Arrangement)**。只有学会了控制位置，Box 才能发挥真正的威力。